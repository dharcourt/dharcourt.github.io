/**
 * @module ui/hazard/hazard-summary.reel
 */
var Component = require("montage/ui/component").Component,
    Hazard = require("logic/mock-model/hazard").Hazard;

/**
 * @class HazardSummary
 * @extends Component
 */
exports.HazardSummary = Component.specialize(/** @lends HazardSummary# */ {
    constructor: {
        value: function HazardSummary() {

        }
    },
    _creationDate: {
        set: function(text) {
            text.converter = this._dateConverter;
        }
    },
    _dateConverter: {
        value: {
            convert: function(input) {
                return input ? input.format("M.DD.YYYY H\\h:mm\\m") : "";
            }
        }
    },
    draw: {
        value: function () {
            if (this.hazard && this.hazard.layer) {
                var style = this.hazard.layer.renderer.render(this.hazard.properties),
                    backgroundHeight = 42 * style.size.height / style.size.width;
                this.icon.style.backgroundSize = "42px " + backgroundHeight + "px";
                this.icon.style.height = (backgroundHeight + 2) + "px";
                this.icon.style.backgroundImage = 'url('+this.__iconUrl+')';
            }
        }
    },
    _hazardType: {
        set: function(value) {
            if (this.__hazardType !== value) {
                this._previousHazardType = this.__hazardType;
                this.__hazardType = value;
            }
        }
    },
    __hazardType: {
        value: null
    },
    _hazard: {
        value: null // Value to be set by this component's owner.
    },
    hazard: {
        get: function() {
            return this._hazard;
        },
        set: function(value) {
            if (value && value.properties && this._hazard !== value) {
                this._hazardType = value.properties.typeId;
                this._hazard = value;
                this.__iconUrl = this._hazard.properties.icon;
                this.needsDraw = true;
            }
        }
    },
    __iconUrl: {
        value: ""
    },
    _iconUrl: {
        get: function() {
            return this.__iconUrl;
        },
        set:function(value) {
            this.__iconUrl = value;
            this.needsDraw = true;
        }
    },

    _previousHazardType: {
        value: null
    }
});
