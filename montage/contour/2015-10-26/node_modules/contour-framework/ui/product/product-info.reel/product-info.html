<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="product-info.css">
    <script type="text/montage-serialization">
    {
        "owner": {
            "properties": {
                "element": {"#": "owner"},
                "_editBar": {"@": "editBar"}
            },
            "bindings": {
                "classList.has('contour-ProductInfo--isEditMode')": {"<-": "@owner.isEditMode"}
            }

        },
        "editBar": {
            "prototype": "ui/control/edit-bar.reel",
            "properties": {
                "element": {"#": "editBar"},
                "hasCancel": true
            },
            "bindings": {
                "title": {"<-": "@owner._isNewProduct ? 'Add Product' : 'Edit Product'"},
                "hasAdd": {"<-": "@owner.isEditMode && @owner._isNewProduct"},
                "hasSave": {"<-": "@owner.isEditMode && !@owner._isNewProduct"}
            }
        },
        "nameEditor": {
            "prototype": "ui/control/text-field.reel",
            "properties": {
                "element": {"#": "nameEditor"}
            },
            "bindings": {
                "value": {"<->": "@owner.product.name"},
                "enabled": {"<-": "@owner.isEditMode"}
            }
        },
        "nameEditorLabel": {
            "prototype": "ui/control/label.reel",
            "properties": {
                "element": {"#": "nameEditorLabel"},
                "label": "Name"
            },
            "bindings": {
                "isActive": {"<-": "@nameEditor.hasFocus || @nameEditor.value"},
                "hasFocus": {"<-": "@nameEditor.hasFocus"},
                "enabled": {"<-": "@nameEditor.enabled"}
            }
        },
        "typeEditor": {
            "prototype": "ui/product/product-type-editor.reel",
            "properties": {
                "element": {"#": "type"},
                "multiSelect": false
            },
            "bindings": {
                "selection.0": {"<->": "@owner.product.type"},
                "classList.has('contour-ProductInfo--hidden')": {"<-": "!@owner.isEditMode || !@owner._isNewProduct"}
            }
        },
        "listUnderFolder": {
            "prototype": "montage/ui/component",
            "properties": {
                "element": {"#": "listUnderFolder"},
                "hasTemplate": false
            }
        },
        "listUnderFolderHeadingBar": {
            "prototype": "ui/control/heading-bar.reel",
            "properties": {
                "element": {"#": "listUnderFolderHeadingBar"},
                "level": 2,
                "heading": "List Under Folder"
            }
        },
        "listUnderFolderLabel": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "listUnderFolderLabel"}
            },
            "bindings": {
                "value": {"<-": "@owner._productParent"}
            }
        },
        "ownerOrganizationHeadingBar": {
            "prototype": "ui/control/heading-bar.reel",
            "properties": {
                "element": {"#": "ownerOrganizationHeadingBar"},
                "level": 2,
                "heading": "Owner Organization"
            }
        },
        "ownerOrganization": {
            "prototype": "montage/ui/component",
            "properties": {
                "element": {"#": "ownerOrganization"},
                "hasTemplate": false
            }
        },
        "ownerOrganizationLabel": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "ownerOrganizationLabel"}
            },
            "bindings": {
                "value": {"<-": "@owner.product.orgAcronym"}
            }
        },

        "commentEditor": {
            "prototype": "ui/control/text-area.reel",
            "properties": {
                "element": {"#": "commentEditor"}
            },
            "bindings": {
                "value": {"<->": "@owner.product.comment"}
            }
        },
        "infoHeader": {
            "prototype": "montage/ui/component",
            "properties": {
                "element": {"#": "infoHeader"},
                "hasTemplate": false
            },
            "bindings": {
                 "classList.has('contour-ProductInfo--isFolder')": {"<-": "@owner.product.type.id == 'FOLDER_PRODUCT'"},
                 "classList.has('contour-ProductInfo--isNonImageFile')": {"<-": "@owner.product.type.id == 'FILE_PRODUCT' && !@owner._isImageFile()"},
                 "classList.has('contour-ProductInfo--isUrl')": {"<-": "@owner.product.type.id == 'URL_PRODUCT'"},
                 "classList.has('contour-ProductInfo--isText')": {"<-": "@owner.product.type.id == 'TEXT_PRODUCT'"}
            }
        },
        "commentEditorLabel": {
            "prototype": "ui/control/label.reel",
                "properties": {
                "element": {"#": "commentEditorLabel"},
                "label": "Comment"
            },
            "bindings": {
                "isActive": {"<-": "@commentEditor.hasFocus || @commentEditor.value"},
                "hasFocus": {"<-": "@commentEditor.hasFocus"},
                "enabled": {"<-": "@commentEditor.enabled"}
            }
        },
        "commentText": {
            "prototype": "ui/control/text-area.reel",
            "properties": {
                "element": {"#": "commentText"},
                "enabled": false
            },
            "bindings": {
                "value": {"<-": "@owner.product.comment"}
            }
        },
        "commentTextLabel": {
            "prototype": "ui/control/label.reel",
                "properties": {
                "element": {"#": "commentTextLabel"},
                "label": "Comment"
            },
            "bindings": {
                "isActive": {"<-": "@commentEditor.hasFocus || @commentEditor.value"},
                "hasFocus": {"<-": "@commentEditor.hasFocus"},
                "enabled": {"<-": "@commentEditor.enabled"}
            }
        },
        "displayHidden": {
            "prototype": "ui/control/toggle-bar.reel",
            "properties": {
                "element": {"#": "displayHidden"},
                "label": "Is Product Hidden?"
            },
            "bindings": {
                "checked": {"<-": "@owner.product.isHidden == 'N' ? false : true"}
            }
        },
        "fileInput": {
            "prototype": "montage/ui/component",
            "properties": {
                "element": {"#": "fileInput"},
                "hasTemplate": false
            }
        },
        "fileName": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "fileName"}
            },
            "bindings": {
                "value": {"<-": "@owner.product.fileName.defined() ? @owner.product.fileName : 'No File Selected'"}
            }
        },
        "fileUploadLabel": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "fileUploadLabel"},
                "value": "Upload File"
            }
        },
        "textValue": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "textValue"}
            },
            "bindings": {
                "value": {"<-": "@owner[@textRepetition:iteration.object.propertyName]"}
            }
        },
        "textLabel": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "textLabel"}
            },
            "bindings": {
                "value": {"<-": "@textRepetition:iteration.object.label"}
            }
        },
        "textArea": {
            "prototype": "ui/control/text-area.reel",
            "properties": {
                "element": {"#": "textArea"}
            },
            "bindings": {
                "value": {"<->": "@owner.product.text"},
                "enabled": {"<-": "@owner.isEditMode"}
            }
        },
        "textAreaLabel": {
            "prototype": "ui/control/label.reel",
            "properties": {
                "element": {"#": "textAreaLabel"},
                "label": "Text"
            },
            "bindings": {
                "isActive": {"<-": "@textArea.hasFocus || @textArea.value"},
                "hasFocus": {"<-": "@textArea.hasFocus"},
                "enabled": {"<-": "@textArea.enabled"}
            }
        },
        "textField": {
            "prototype": "ui/control/text-field.reel",
            "properties": {
                "element": {"#": "textField"}
            },
            "bindings": {
                "value": {"<->": "@owner.product.url"},
                "enabled": {"<-": "@owner.isEditMode"}
            }
        },
        "textFieldLabel": {
            "prototype": "ui/control/label.reel",
            "properties": {
                "element": {"#": "textFieldLabel"},
                "label": "URL"
            },
            "bindings": {
                "isActive": {"<-": "@textField.hasFocus || @textField.value"},
                "hasFocus": {"<-": "@textField.hasFocus"},
                "enabled": {"<-": "@textField.enabled"}
            }
        },
        "previewContainer": {
            "prototype": "montage/ui/condition.reel",
            "properties": {
                "element": {"#": "previewContainer"}
            },
            "bindings": {
                "condition": {"<-": "@owner.product.type.id == 'FILE_PRODUCT'"}
            }
        },
        "preview": {
            "prototype": "ui/base/image.reel",
            "properties": {
                "element": {"#": "preview"}
            },
            "bindings": {
                "src": {"<-": "'http://servicestest.pdc.org/hazards/api?m=hazards_products&action=showPreviewThumbnail&product=' + @owner.product.id + '&w=600&h=600&iar=1'"}
            }
        },
        "previewLabel": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "previewLabel"},
                "value": "Preview"
            }
        },
        "editorSubstitution": {
            "prototype": "montage/ui/substitution.reel",
            "properties": {
                "element": {"#": "editorSubstitution"}
            },
            "bindings": {
                "switchValue": {"<-": "@owner.product.type.defined() ? @owner.product.type.id : 'FOLDER_PRODUCT'"}
            }
        },
        "substitution": {
            "prototype": "montage/ui/substitution.reel",
            "properties": {
                "element": {"#": "substitution"}
            },
            "bindings": {
                "switchValue": {"<-": "@owner.isEditMode ?  'edit' : 'inspect'"}
            }
        },
        "textRepetition": {
            "prototype": "montage/ui/repetition.reel",
            "properties": {
                "element": {"#": "textRepetition"},
                "isSelectionEnabled": false,
                "content": [
                    {
                        "label": "Is Product Hidden?",
                        "propertyName": "_isProductHidden"
                    },
                    {
                        "label": "List Under Folder",
                        "propertyName": "_productParent"
                    },
                    {
                        "label": "Owner Organization",
                         "propertyName": "_productOrganization"
                    }
                ]
            }
        }
    }
    </script>
</head>
<body>
    <div data-montage-id="owner" class="contour-ProductInfo">
        <div data-montage-id="editBar" class="contour-ProductInfo-editBar"></div>
        <div class="contour-ProductInfo-contentWrapper">
            <div data-montage-id="infoHeader" class="contour-ProductInfo-infoHeader">
                <div data-montage-id="nameEditorLabel" class="contour-ProductInfo-nameEditorLabel">
                    <div data-montage-id="nameEditor" data-arg="input"></div>
                </div>
            </div>
            <div data-montage-id="type" class="contour-ProductInfo-typeEditor"></div>
            <div data-montage-id="editorSubstitution" class="contour-ProductInfo-editorSubstitution">
                <div data-arg="TEXT_PRODUCT">
                    <div data-montage-id="textAreaLabel" class="contour-ProductInfo-textAreaLabel">
                        <div data-montage-id="textArea" class="contour-ProductInfo-textArea" data-arg="input"></div>
                    </div>
                </div>

                <div data-arg="URL_PRODUCT">
                    <div data-montage-id="textFieldLabel" class="contour-ProductInfo-textFieldLabel">
                        <div data-montage-id="textField" class="contour-ProductInfo-textField" data-arg="input"></div>
                    </div>
                </div>

                <div data-arg="FOLDER_PRODUCT"></div>

                <div data-arg="FILE_PRODUCT" class="contour-ProductInfo-fileEditor">
                    <div data-montage-id="fileUploadLabel" class="contour-ProductInfo-fileUploadLabel"></div>
                    <div data-montage-id="fileName" class="contour-ProductInfo-fileName"></div>
                    <input type="file" data-montage-id="fileInput" class="contour-ProductInfo-fileInput" />
                </div>
            </div>

            <div data-montage-id="substitution" >
                <div data-arg="edit" class="contour-ProductInfo-edit">

                    <div data-montage-id="displayHidden" class="contour-ProductInfo-toggleBar"></div>
                    <!--Comment-->
                    <div data-montage-id="commentEditorLabel" class="contour-ProductInfo-commentLabel">
                        <div data-montage-id="commentEditor" class="editor contour-ProductInfo-commentEditor" data-arg="input"></div>
                    </div>
                    <div data-montage-id="listUnderFolderHeadingBar" class="contour-ProductInfo-listUnderFolderHeadingBar"></div>
                    <div data-montage-id="listUnderFolder" class="contour-ProductInfo-container contour-ProductInfo-listUnderFolder">
                        <div data-montage-id="listUnderFolderLabel" class="contour-ProductInfo-label"></div>
                    </div>
                    <div data-montage-id="ownerOrganizationHeadingBar" class="contour-ProductInfo-ownerOrganizationHeadingBar"></div>
                    <div data-montage-id="ownerOrganization" class="contour-ProductInfo-container contour-ProductInfo-ownerOrganization">
                        <div data-montage-id="ownerOrganizationLabel" class="contour-ProductInfo-label"></div>
                    </div>
                </div>
                <div data-arg="inspect" class="contour-ProductInfo-inspect">
                    <div data-montage-id="textRepetition">
                        <div class="contour-ProductInfo-container">
                            <div data-montage-id="textLabel" class="contour-ProductInfo-label"></div>
                            <div data-montage-id="textValue" class="contour-ProductInfo-text"></div>
                        </div>
                    </div>

                    <div data-montage-id="commentTextLabel" class="contour-ProductInfo-commentLabel">
                        <div data-montage-id="commentText" class="contour-ProductInfo-commentText" data-arg="input"></div>
                    </div>
                    <!-- Preview -->

                    <div data-montage-id="previewContainer" class="contour-ProductInfo-previewContainer">
                        <div data-montage-id="previewLabel" class="contour-ProductInfo-label"></div>
                        <img data-montage-id="preview" class="contour-ProductInfo-preview" />
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
