<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="map-export-inspector.css">
    <script type="text/javascript" src="assets/canvas-to-blob.min.js"></script>
    <script type="text/montage-serialization">
    {
        "owner": {
            "properties": {
                "element": {"#": "owner"},
                "editBar": {"@": "editBar"},
                "jpegPreview": {"@": "jpegPreview"},
                "jpegPreviewWrapper": {"#": "jpegPreviewWrapper"},
                "hiddenCanvas": {"#": "hiddenCanvas"},
                "previewHeader": {"@": "previewHeader"}
            }
        },
        "actionBar": {
            "prototype": "montage/ui/substitution.reel",
            "properties": {
                "element": {"#": "actionBar"}
            },
            "bindings": {
                "switchValue": {"<-": "@owner.currentState"}
            }
        },
        "editBar": {
            "prototype": "ui/control/edit-bar.reel",
            "properties": {
                "element": {"#": "editBar"},
                "hasCancel": true,
                "hasSave": true,
                "title": "New Export"
            }
        },
        "exportFormatSelector": {
            "prototype": "ui/control/select-bar.reel",
            "properties": {
                "element": {"#": "exportFormatSelector"},
                "options": [
                    {"label": "KML", "value": "kml"},
                    {"label": "GPX", "value": "gpx"},
                    {"label": "JPEG", "value": "jpeg"}
                ]
            },
            "bindings": {
                "value": {"<->": "@owner.format"}
            }
        },
        "exportLegendToggle": {
            "prototype": "ui/control/toggle-bar.reel",
            "properties": {
                "element": {"#": "exportLegendToggle"},
                "label": "Export Legend"
            },
            "bindings": {
                "checked": {"<->": "@owner.exportLegend"}
            }
        },
        "generateJpegPreviewText": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "generateJpegPreviewText"},
                "value": "Press the generate link to create the preview."
            }
        },
        "processingJpegPreviewText": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "processingJpegPreviewText"},
                "value": "Processing preview please wait."
            }
        },
        "jpegPreviewProcessingFailedText": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "jpegPreviewProcessingFailedText"}
            },
            "bindings": {
                "value": {"<-": "'Unable to process preview.  Processing failed with message: ' + @owner.errorMessage"}
            }
        },
        "jpegPreview": {
            "prototype": "montage/ui/component",
            "properties": {
                "element": {"#": "jpegPreview"},
                "hasTemplate": false
            },
            "bindings": {
                "classList.has('contour-MapExportInspector-jpegPreview--visible')": {"<-": "@owner.isJpegGenerated"}
            }
        },
        "previewHeader": {
            "prototype": "ui/control/heading-bar.reel",
            "properties": {
                "element": {"#": "previewHeader"},
                "heading": "Thumbnail Preview",
                "level": 2
            },
            "bindings": {
                "actionLabel": {"<-": "@owner.previewGenerationState == 0 ? 'Regenerate' : 'Generate'"}
            }
        },
        "jpegExportState": {
            "prototype": "montage/ui/substitution.reel",
            "properties": {
                "element": {"#": "jpegExportState"}
            },
            "bindings": {
                "switchValue": {"<-": "@owner.previewGenerationState"}
            }
        },
        "jpegOptions": {
            "prototype": "montage/ui/component",
            "properties": {
                "element": {"#": "jpegOptions"},
                "hasTemplate": false
            },
            "bindings": {
                "classList.has('contour-MapExportInspector-jpegOptions--visible')": {"<-": "@owner.format == 'jpeg'"}
            }
        },
        "name": {
            "prototype": "ui/control/text-field.reel",
            "properties": {
                "element": {"#": "name"},
                "enabled": true
            },
            "bindings": {
                "value": {"<-": "@owner.filename"}
            }
        },
        "nameLabel": {
            "prototype": "ui/control/label.reel",
            "properties": {
                "element": {"#": "nameLabel"},
                "label": "Name"
            },
            "bindings": {
                "isActive": {"<-": "@name.hasFocus || @name.value"},
                "enabled": {"<-": "@name.enabled"}
            }
        }
    }
    </script>
</head>
<body>
    <div data-montage-id="owner" class="contour-MapExportInspector">
        <div data-montage-id="actionBar">
            <div data-montage-id="editBar" data-arg="0" class="contour-MapExportInspector-editBar"></div>
        </div>
        <div class="contour-MapExportInspector-wrapper">
            <div data-montage-id="nameLabel" class="contour-MapExportInspector-nameLabel">
                <div data-montage-id="name" class="contour-MapExportInspector-name" data-arg="input"></div>
            </div>
            <div data-montage-id="exportFormatSelector" class="contour-MapExportInspector-exportFormatSelectBar"></div>
            <div data-montage-id="jpegOptions" class="contour-MapExportInspector-jpegOptions">
                <div data-montage-id="exportLegendToggle" class="contour-MapExportInspector-exportLegendToggle"></div>
                <div data-montage-id="previewHeader" class="contour-MapExportInspector-previewHeader"></div>
                <div data-montage-id="jpegExportState">
                    <div data-montage-id="jpegPreviewWrapper" data-arg="0" class="contour-MapExportInspector-jpegPreviewWrapper">
                        <img data-montage-id="jpegPreview" class="contour-MapExportInspector-jpegPreview" />
                    </div>
                    <div data-montage-id="processingJpegPreviewText" data-arg="1" class="contour-MapExportInspector-generateJpegPreviewText"></div>
                    <div data-montage-id="jpegPreviewProcessingFailedText" data-arg="2" class="contour-MapExportInspector-generateJpegPreviewText"></div>
                    <div data-montage-id="generateJpegPreviewText" data-arg="3" class="contour-MapExportInspector-generateJpegPreviewText"></div>
                </div>
                <canvas data-montage-id="hiddenCanvas" class="contour-MapExportInspector-hiddenCanvas"></canvas>
            </div>
        </div>
    </div>
</body>
</html>
