/**
 * @module ui/camera/camera-info.reel
 * @requires montage/ui/component
 */
var Component = require("montage/ui/component").Component,
    PressComposer = require("montage/composer/press-composer").PressComposer;

/**
 * @class TvMsnbc
 * @extends Component
 */
exports.TvMsnbc = Component.specialize(/** @lends TvMsnbc# */ {
    constructor: {
        value: function TvMsnbc() {

        }
    },

    _isVisible: {
        value: false
    },

    isVisible: {
        set: function (value) {
            this._isVisible = value;
            if (value) {
                this.needsDraw = true;
                this._needsInitChannel = true;
            }
        },
        get: function () {
            return this._isVisible;
        }
    },

    initChannel: {
        value: function () {
            var self = this;
            if (typeof jwebcam === 'undefined') {
                this._loadSource('http://relay.ozolio.com/js/jozolio.js', function () {
                    self._loadSource('http://relay.ozolio.com/js/jwebcam.js', function () {
                        self._loadSource('http://relay.ozolio.com/js/swfobject.js', function () {
                            self._initWebCam();
                        });
                    });
                });
            } else {
                this._initWebCam();
            }
        }
    },

    _initWebCam: {
        value: function () {
            var camvars = {},
                params = {};
            var element =  document.getElementById('msnbc_web_holder');
            if (element.children.length === 0) {
                camvars.domain = "https://relay.ozolio.com";
                camvars.camera_doc = 'CID_SSVR00000043';
                camvars.app_mode = "simple";
                camvars.chn_mode = "none";
                params.allowFullScreen = "true";
                params.allowScriptAccess = "always";
                self.webcam = new jwebcam(camvars, "msnbc_web_holder", 420, 360, params);
            }
        }
    },

    _loadSource: {
        value: function (url, callBack) {
            var script = document.createElement("script");
            script.onload = function () {
                callBack();
            };
            script.type = "text/javascript";
            script.src = url;
            document.body.appendChild(script);
        }
    },

    draw: {
        value: function () {

            if (this._needsInitChannel) {
                this.initChannel();
            }
        }
    }

});
