<!DOCTYPE html>
<html>
<head>
    <title></title>
    <link rel="stylesheet" type="text/css" href="timeline-bar.css">
    <script type="text/montage-serialization">
    {
        "owner": {
            "properties": {
                "element": {"#": "owner"},
                "_superTimelineElement": {"#": "superTimeline"},
                "_timelineElement": {"#": "timeline"},
                "_bufferSlider": {"@": "bufferSlider"},
                "_bufferSliderFill": {"#": "bufferSliderFill"},
                "_control": {"@": "control"},
                "_showSpeedControls": {"@": "showSpeedControls"},
                "_speedControls": {"@": "speedControls"}
            }
        },
        "bufferSlider": {
            "prototype": "ui/base/slider.reel",
            "properties": {
               "element": {"#": "bufferSlider"},
               "_sliderThumbElement": {"#": "bufferSliderThumb"},
               "step": 1,
               "min": -1
            },
            "bindings": {
                "max": {"<-": "@owner.animationController.timestamps.length - 1"},
                "value": {"<->": "@owner._currentTimeIndex"},
                "classList.has('contour-TimelineBar--halfSpeed')": {"<-": "@owner.animationController.speed == 4000 && !_isUpdatingTranslate"},
                "classList.has('contour-TimelineBar--normalSpeed')": {"<-": "@owner.animationController.speed == 2000 && !_isUpdatingTranslate"},
                "classList.has('contour-TimelineBar--doubleSpeed')": {"<-": "@owner.animationController.speed == 1000 && !_isUpdatingTranslate"},
                "classList.has('contour-TimelineBar--quadSpeed')": {"<-": "@owner.animationController.speed == 500 && !_isUpdatingTranslate"}
            }
        },

        "control": {
            "prototype": "ui/base/button.reel",
            "properties": {
               "element": {"#": "control"},
               "hasTemplate": false
            },
            "bindings": {
                "classList.has('contour-TimelineBar-control--play')": {"<-": "@owner.animationController.status == 0 || @owner.animationController.status == 1"},
                "classList.has('contour-TimelineBar-control--pause')": {"<-": "@owner.animationController.status == 2"}
            }
        },
        "superTimeline":{
            "prototype": "montage/ui/repetition.reel",
            "properties": {
                "element": {"#": "superTimeline"}
            },
            "bindings": {
                "content": {"<-": "@owner._superTimes"}
            }
        },
        "superTimelineItem": {
            "prototype": "montage/ui/component",
            "properties": {
                "element": {"#": "superTimelineItem"},
                "hasTemplate": false
            },
            "bindings": {
                "item": {"<-": "@superTimeline:iteration.object.moment"},
                "flex": {"<-": "@superTimeline:iteration.object.subTimes.length / @owner._times.length"},
                "classList.has('contour-TimelineBar-superTimelineItem--current')": {"<-": "@owner._currentMoment.day() == item.day()"}
            }
        },
        "superItemText": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "superItemText"},
                "hasTemplate": false
            },
            "bindings": {
                "value": {"<-": "@superTimeline:iteration.object.moment"},
                "converter": {"<-": "@owner._superDateConverter"}
            }
        },
        "timeline":{
            "prototype": "montage/ui/repetition.reel",
            "properties": {
                "element": {"#": "timeline"}
            },
            "bindings": {
                "content": {"<-": "@owner._times"}
            }
        },
        "timelineItem": {
            "prototype": "montage/ui/component",
            "properties": {
                "element": {"#": "timelineItem"},
                "hasTemplate": false
            },
            "bindings": {
                "item": {"<-": "@timeline:iteration.object"}
            }
        },
        "itemText": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "itemText"}
            },
            "bindings": {
                "value": {"<-": "@timeline:iteration.object"},
                "converter": {"<-": "@owner._dateConverter"}
            }
        },
        "subItemText": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "subItemText"}
            },
            "bindings": {
                "value": {"<-": "@owner._currentMoment"},
                "converter": {"<-": "@owner._dateConverter"}
            }
        },
        "speedControls":{
            "prototype": "montage/ui/repetition.reel",
            "properties": {
                "element": {"#": "speedControls"},
                "content": [
                    {
                        "display": ".5x",
                        "value": 4000
                    },
                    {
                        "display": "1x",
                        "value": 2000
                    },
                    {
                        "display": "2x",
                        "value": 1000
                    },
                    {
                        "display": "4x",
                        "value": 500
                    }
                ]
            },
            "bindings": {
                "classList.has('contour-TimelineBar-speedControls--hidden')": {"<-": "!@owner._areSpeedControlsVisible"}
            }
        },
        "speedControl": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "speedControl"}
            },
            "bindings": {
                "value": {"<-": "@speedControls:iteration.object.display"},
                "speed": {"<-": "@speedControls:iteration.object.value"},
                "classList.has('contour-TimelineBar-speedControl--selected')": {"<-": "speed == @owner._animationController.speed"}
            }
        },
        "showSpeedControls": {
            "prototype": "montage/ui/text.reel",
            "properties": {
                "element": {"#": "showSpeedControls"},
                "hasTemplate": false
            },
            "bindings": {
                "value": {"<-": "@speedControls.content.filter{value == @owner._animationController.speed}.get(0).display"},
                "classList.has('contour-TimelineBar-showSpeedControls--hidden')": {"<-": "@owner._areSpeedControlsVisible"}
            }
        }
    }
    </script>
</head>
<body>
    <div data-montage-id="owner" class="contour-TimelineBar">
        <div data-montage-id="control" class="contour-TimelineBar-control"></div>
        <div data-montage-id="speedControls" class="contour-TimelineBar-speedControls contour-TimelineBar-speedControls--hidden">
            <div data-montage-id="speedControl" class="contour-TimelineBar-speedControl"></div>
        </div>
        <div data-montage-id="showSpeedControls" class="contour-TimelineBar-showSpeedControls"></div>
        <div class="contour-TimelineBar-horizontalContainer">
            <div data-montage-id="bufferSlider" class="contour-TimelineBar-bufferSlider">
                <div data-montage-id="bufferSliderFill" class="contour-TimelineBar-bufferSliderFill"></div>
                <div data-montage-id="bufferSliderThumb" class="contour-TimelineBar-bufferSliderThumb"></div>

            </div>

            <div data-montage-id="superTimeline" class="contour-TimelineBar-superTimeline">
                <div data-montage-id="superTimelineItem" class="contour-TimelineBar-superTimelineItem">
                    <span data-montage-id="superItemText" class="contour-TimelineBar-superItemText"></span>
                    <span data-montage-id="subItemText" class="contour-TimelineBar-subItemText"></span>
                </div>
            </div>

            <div data-montage-id="timeline" class="contour-TimelineBar-timeline">
                <div data-montage-id="timelineItem" class="contour-TimelineBar-timelineItem">
                    <span data-montage-id="itemText" class="contour-TimelineBar-itemText"></span>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
